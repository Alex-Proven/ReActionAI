<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <TargetFramework>net48</TargetFramework>
        <Platforms>x64</Platforms>
        <LangVersion>latest</LangVersion>
        <Nullable>enable</Nullable>
        <UseWPF>true</UseWPF>

        <!-- Пути сборки -->
        <OutputPath>bin\x64\$(Configuration)\</OutputPath>
        <DisableFastUpToDateCheck>true</DisableFastUpToDateCheck>

        <!-- Важные переменные Revit -->
        <RevitYear>2024</RevitYear>
        <RevitAddinDir>$(APPDATA)\Autodesk\Revit\Addins\$(RevitYear)</RevitAddinDir>
        <ThisModuleName>ReActionAI.Integration.Revit</ThisModuleName>
        <ThisModuleAddin>$(ProjectDir)$(ThisModuleName).addin</ThisModuleAddin>
        <ReActionAddinDir>$(RevitAddinDir)\ReActionAI</ReActionAddinDir>
    </PropertyGroup>

    <ItemGroup>
      <None Remove="Resources\icon32.png" />
    </ItemGroup>

    <ItemGroup>
      <PackageReference Include="NHyphenator" Version="2.0.0" />
    </ItemGroup>

    <!-- Ссылки на проекты -->
    <ItemGroup>
        <ProjectReference Include="..\..\Abstractions\ReActionAI.Abstractions\ReActionAI.Abstractions.csproj" />
        <ProjectReference Include="..\..\ReActionAI\ReActionAI.Core.csproj" />
    </ItemGroup>

    <!-- Ссылки на WPF -->
    <ItemGroup>
        <Reference Include="AdWindows">
          <HintPath>..\..\..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\AdWindows.dll</HintPath>
          <Aliases>global,AdWin</Aliases>
        </Reference>
        <Reference Include="System.Net.Http" />
        <Reference Include="WindowsBase" />
        <Reference Include="PresentationCore" />
        <Reference Include="PresentationFramework" />
    </ItemGroup>

    <!-- Ссылки на Revit API -->
    <ItemGroup>
        <Reference Include="RevitAPI">
            <HintPath>$(ProgramFiles)\Autodesk\Revit 2024\RevitAPI.dll</HintPath>
            <Private>false</Private>
        </Reference>

        <Reference Include="RevitAPIUI">
            <HintPath>$(ProgramFiles)\Autodesk\Revit 2024\RevitAPIUI.dll</HintPath>
            <Private>false</Private>
        </Reference>
    </ItemGroup>
    <ItemGroup>
      <Resource Include="Resources\icon32.png">
        <CopyToOutputDirectory>Always</CopyToOutputDirectory>
      </Resource>
    </ItemGroup>

    <!-- Добавляем звуковой файл send_click.wav как Content с CopyIfNewer -->
    <ItemGroup>
      <Content Include="Resources\send_click.wav">
        <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
      </Content>
    </ItemGroup>
    <Target Name="PostBuild" AfterTargets="PostBuildEvent">
      <Exec Command="REM === ПУТИ ===&#xD;&#xA;SET &quot;ADDIN_DIR=%25AppData%25\Autodesk\Revit\Addins\2024&quot;&#xD;&#xA;SET &quot;DEST=%25ADDIN_DIR%25\ReActionAI&quot;&#xD;&#xA;&#xD;&#xA;REM === СОЗДАЁМ ПАПКУ ДЛЯ DLL ===&#xD;&#xA;IF NOT EXIST &quot;%25DEST%25&quot; mkdir &quot;%25DEST%25&quot;&#xD;&#xA;&#xD;&#xA;REM === КОПИРУЕМ DLL ТЕКУЩЕГО МОДУЛЯ ===&#xD;&#xA;copy /Y &quot;$(TargetPath)&quot; &quot;%25DEST%25&quot;&#xD;&#xA;&#xD;&#xA;REM === КОПИРУЕМ DLL Abstractions ===&#xD;&#xA;copy /Y &quot;$(ProjectDir)..\..\Abstractions\ReActionAI.Abstractions\bin\x64\$(Configuration)\net48\ReActionAI.Abstractions.dll&quot; &quot;%25DEST%25&quot;&#xD;&#xA;&#xD;&#xA;REM === КОПИРУЕМ DLL ядра ReActionAI ===&#xD;&#xA;copy /Y &quot;$(ProjectDir)..\..\ReActionAI\bin\x64\$(Configuration)\net48\ReActionAI.dll&quot; &quot;%25DEST%25&quot;&#xD;&#xA;&#xD;&#xA;REM === КОПИРУЕМ .ADDIN В КОРЕНЬ Addins\2024 ===&#xD;&#xA;copy /Y &quot;$(ProjectDir)ReActionAI.Integration.Revit.addin&quot; &quot;%25ADDIN_DIR%25&quot;&#xD;&#xA;&#xD;&#xA;REM === КОПИРУЕМ РЕСУРСЫ (звук) В ПАПКУ ADDIN ===&#xD;&#xA;copy /Y &quot;$(ProjectDir)Resources\send_click.wav&quot; &quot;%25DEST%25\send_click.wav&quot;" />
    </Target>

</Project>
