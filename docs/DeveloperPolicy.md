# Политика разработчика ReActionAI

Версия: 1.3  
Дата: 23.11.2025

---

## 1. Общие принципы

1.1. Цель панели ReActionAI – дать проектировщику в Revit *стабильный и удобный рабочий инструмент*, а не «минимальный рабочий вариант».

1.2. Любой элемент интерфейса, который видит пользователь, *должен иметь осмысленное поведение*.  
Запрещено выводить в UI «пустые» кнопки и элементы без логики.

1.3. Термин «MVP» в контексте пользовательской панели *не используется*.  
Первый этап для пользователя – это уже *полноценный рабочий сценарий*, согласованный с Заказчиком.

1.4. Плагин никогда не должен ломать работу Revit:
ошибки сетевых сервисов, отсутствующий ключ API, проблемы конфигурации и т.п. *не должны приводить к падению загрузки аддена*;
в таких случаях плагин переходит в безопасный режим (демо/ограниченный функционал) с понятным сообщением пользователю.

---

## 2. Правила взаимодействия ассистента (ChatGPT) с кодом

2.1. При внесении изменений помощник обязан выдавать *полный код всех затронутых файлов*, пригодный для прямой замены.  
Фрагменты и «патчи по месту» допускаются только по прямому запросу пользователя.

2.2. Изменения должны быть *локальны задаче*:
нельзя «по дороге» менять не относящиеся к задаче части UI или логики;
каждый шаг работы фиксируется в комментариях/коммитах.

2.3. Любые изменения должны:
компилироваться без ошибок;
не ухудшать внешний вид панели, если иное не согласовано отдельно.

2.4. При объяснении изменений ассистент обязан:
указывать, какие файлы изменены;
кратко описывать смысл изменений;
не скрывать технических деталей от разработчика, но не путать их с текстами для конечного пользователя.

---

## 3. Требования к пользовательской панели ReActionAI – Ассистент

3.1. Базовая структура панели:
Заголовок: ReActionAI – Ассистент, с выравниванием правого края по правому краю области сообщений.
Основная область – история сообщений (ScrollViewer + вертикальная панель сообщений).
Нижняя область – панель ввода:
  - слева круглая кнопка +;
  - по центру – контейнер с полем ввода текста и placeholder’ом «Введите сообщение…»;
  - справа внутри контейнера – круглая кнопка отправки.

3.2. Принципы оформления сообщений:
сообщения ассистента помечаются автором *«Феникс»*;
сообщения пользователя – автором *«Вы»*;
текст переносится по словам (word wrap);
отступы и тени настроены так, чтобы панель выглядела аккуратно и не «прыгала» при вводе.

3.3. *Кнопка «+» – переключатель текстового стиля (обязательное поведение)*

3.3.1. Кнопка + всегда отвечает за *переключение режима оформления текста чата*:
режим 1: *чёрно-белый* (монохромный, минималистичный, без цветных акцентов);
режим 2: *цветной* (используются фирменные цвета ReActionAI: акценты для автора, кнопок, ссылок).

3.3.2. При каждом нажатии + режим переключается:
из чёрно-белого → в цветной;
из цветного → обратно в чёрно-белый.

3.3.3. Требования к реализации:
состояние режима хранится в экземпляре ChatPanel (например, ColorMode: Monochrome | Color);
переключение режима *меняет стили уже отрисованных сообщений и панели ввода*, а не только новых сообщений;
при переключении не допускается «мигание» или перерисовка с потерей прокрутки;
режим по умолчанию определяется Политикой дизайна (на текущий момент: *чёрно-белый*).

3.3.4. Запрещено:
оставлять кнопку + без обработчика;
использовать кнопку + для любой другой функции, не связанной с переключением стиля, без отдельного изменения Политики.

3.4. Кнопка отправки:
круглая, размер ~24 px;
находится строго внутри контейнера ввода;
имеет отступы 4 px сверху/снизу/справа от границы контейнера;
не меняет высоту контейнера при вводе текста.

3.5. Автоматическая высота поля ввода:
высота ввода увеличивается по мере ввода текста;
при этом нижняя панель остаётся в рамках согласованного дизайна, кнопки не «уползают» и не вылезают за границу.

3.6. Сообщения об ошибках для пользователя:
формулируются простым языком (на русском), без упоминаний типов .NET, пространств имён, стек-трейсов;
техническая информация (название исключения, стек) *может логироваться* во внутренний лог, но не показывается пользователю панели.

Пример правильно оформленного сообщения:
«Сервис ассистента временно недоступен. Вы можете продолжать работу в Revit, а за настройкой подключения обратитесь к BIM-менеджеру.»

---

## 4. Работа с внешним ассистентом (ChatClient и др.)

4.1. Ошибки инициализации ChatClient не должны приводить к падению загрузки Revit-аддена.  
В случае ошибки создаётся безопасный fallback-клиент, который:
возвращает корректный, человеко-понятный текст;
не выдаёт технических деталей реализации.

4.2. Логика fallback-режима:
панель сообщает пользователю, что работает в демонстрационном/ограниченном режиме;
ответы формируются локально или упрощённо;
при восстановлении внешнего сервиса возможно переключение в «боевой» режим (по отдельному решению).

---

## 5. Требования к коду и форматам

5.1. Все файлы исходного кода в репозитории хранятся в кодировке *UTF-8 без BOM, переводы строк – **LF*, если иное не оговорено.

5.2. При инструкциях вида «сохрани как …» ассистент обязан явно указать:
кодировку (UTF-8 / UTF-16 / и др.);
тип перевода строк (LF / CRLF);
необходимость выставить флаг «исполняемый» (для скриптов).

5.3. Для файлов, которые пользователь вставляет в Visual Studio под Windows, по умолчанию допустимы переводы строк *CRLF*, но репозиторий должен оставаться консистентным (LF), если не согласовано иное.

---

## 6. Коммиты и ветки

6.1. Сообщения коммитов:
префикс (тип/область) на английском: feat:, fix:, chore:, refactor:, и т.п.;
описание – на русском языке, кратко и по делу.

6.2. Каждый локальный набор изменений (например, правка панели ввода, изменение поведения кнопки +, подключение звука и т.д.) должен оформляться отдельным коммитом.

6.3. Перед передачей инструкции пользователю ассистент обязан явно указать, что именно надо:
заменить;
пересобрать;
протестировать (при необходимости).

---

## 7. Изменение Политики

7.1. Любое расхождение фактического поведения плагина с данной Политикой считается ошибкой реализации, а не ошибкой пользователя.

7.2. Изменения в Политике инициируются:
пользователем (Заказчиком) проекта;
или по результатам анализа несоответствий, с обязательным согласованием.

7.3. Текущая редакция *отменяет формулировки о «минимальном рабочем варианте»*.  
Цель – *полноценный рабочий пользовательский сценарий* с самого первого этапа, в том числе:
корректная работа кнопки + как переключателя стилизации;
отсутствие «пустых» элементов интерфейса;
отсутствие технической информации в сообщениях пользователю.